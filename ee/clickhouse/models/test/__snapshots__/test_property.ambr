# name: TestPropFormat.test_parse_groups
  '
  SELECT uuid
  FROM events
  WHERE team_id = 2
    AND ((has(['val_1'], replaceRegexpAll(JSONExtractRaw(properties, 'attr_1'), '^"|"$', ''))
          AND has(['val_2'], replaceRegexpAll(JSONExtractRaw(properties, 'attr_2'), '^"|"$', '')))
         OR (has(['val_2'], replaceRegexpAll(JSONExtractRaw(properties, 'attr_1'), '^"|"$', ''))))
  '
---
# name: TestPropFormat.test_parse_groups_persons
  '
  SELECT uuid
  FROM events
  WHERE team_id = 2
    AND ((distinct_id IN
            (SELECT distinct_id
             FROM
               (SELECT distinct_id,
                       argMax(person_id, version) as person_id
                FROM person_distinct_id2
                WHERE team_id = 2
                GROUP BY distinct_id
                HAVING argMax(is_deleted, version) = 0)
             WHERE person_id IN
                 (SELECT id
                  FROM
                    (SELECT id,
                            argMax(properties, person._timestamp) as properties,
                            max(is_deleted) as is_deleted
                     FROM person
                     WHERE team_id = 2
                     GROUP BY id
                     HAVING is_deleted = 0)
                  WHERE has(['1@posthog.com'], replaceRegexpAll(JSONExtractRaw(properties, 'email'), '^"|"$', '')) ) ))
         OR (distinct_id IN
               (SELECT distinct_id
                FROM
                  (SELECT distinct_id,
                          argMax(person_id, version) as person_id
                   FROM person_distinct_id2
                   WHERE team_id = 2
                   GROUP BY distinct_id
                   HAVING argMax(is_deleted, version) = 0)
                WHERE person_id IN
                    (SELECT id
                     FROM
                       (SELECT id,
                               argMax(properties, person._timestamp) as properties,
                               max(is_deleted) as is_deleted
                        FROM person
                        WHERE team_id = 2
                        GROUP BY id
                        HAVING is_deleted = 0)
                     WHERE has(['2@posthog.com'], replaceRegexpAll(JSONExtractRaw(properties, 'email'), '^"|"$', '')) ) )))
  '
---
